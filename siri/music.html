<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Siri Music - musicOS 1.0</title>
<style>
  body {
    background-color: #f0f0f0;
    font-family: 'Helvetica Neue', Arial, sans-serif;
    margin: 0;
    padding: 0;
  }
  /* 헤더 스타일 */
  header {
    background-color: #fff;
    padding: 20px;
    text-align: center;
  }
  /* 메인 컨테이너 */
  .container {
    padding: 20px;
  }
  /* 아티스트 섹션 */
  .artist-section {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .artist-section img {
    width: 100%;
    max-height: 400px;
    object-fit: cover;
  }
  .artist-section h1 {
    margin: 10px 0;
  }
  /* 앨범 리스트 */
  .album-list {
    display: flex;
    overflow-x: scroll;
    padding: 20px 0;
  }
  .album {
    margin-right: 20px;
    text-align: center;
  }
  .album img {
    width: 150px;
    height: 150px;
    object-fit: cover;
    border-radius: 10px;
  }
  /* 노래 리스트 */
  .track-list {
    margin-top: 20px;
  }
  .track {
    padding: 10px;
    border-bottom: 1px solid #ccc;
    cursor: pointer;
  }
  /* 플레이어 */
  .player {
    position: fixed;
    bottom: 0;
    width: 100%;
    background-color: #fff;
    display: none;
    flex-direction: column;
    align-items: center;
    padding: 10px;
  }
  .player.expanded {
    height: 70%;
  }
  .player img {
    width: 50px;
    height: 50px;
  }
  .player.expanded img {
    width: 200px;
    height: 200px;
  }
  .lyrics {
    margin-top: 20px;
    overflow-y: scroll;
    height: 100%;
    display: none;
  }
  .player.expanded .lyrics {
    display: block;
  }
</style>
</head>
<body>

<header>
  <h1>Siri Music</h1>
</header>

<div class="container">
  <!-- 아티스트 섹션 -->
  <div class="artist-section">
    <video width="100%" controls poster="http://www.applesodam.kro.kr/music/NewJeans/NewJeans.jpg">
      <source src="http://www.applesodam.kro.kr/music/NewJeans/NewJeans.mp4" type="video/mp4">
      브라우저가 비디오 태그를 지원하지 않습니다.
    </video>
    <h1>NewJeans</h1>
    <button onclick="playArtist()">재생하기</button>
  </div>

  <!-- 앨범 리스트 -->
  <h2>앨범</h2>
  <div class="album-list">
    <div class="album" onclick="selectAlbum('Get Up')">
      <img src="http://www.applesodam.kro.kr/music/NewJeans/NewJeans2ndEP'GetUp'/NewJeans2ndEP'GetUp'.jpg" alt="Get Up">
      <p>Get Up</p>
    </div>
    <!-- 추가 앨범들은 여기에 -->
  </div>

  <!-- 노래 리스트 -->
  <div class="track-list" id="track-list">
    <!-- 노래 목록이 여기에 동적으로 추가됩니다 -->
  </div>
</div>

<!-- 플레이어 -->
<div class="player" id="player">
  <img src="" alt="Album Art" id="album-art" onclick="togglePlayer()">
  <audio id="audio" ontimeupdate="syncLyrics()"></audio>
  <div class="lyrics" id="lyrics">
    <!-- 가사가 여기에 표시됩니다 -->
  </div>
</div>

<script>
  let tracks = {
    'Get Up': [
      {
        title: 'ETA',
        src: "http://www.applesodam.kro.kr/music/NewJeans/NewJeans2ndEP'GetUp'/ETA.mp3",
        lyrics: "http://www.applesodam.kro.kr/music/NewJeans/NewJeans2ndEP'GetUp'/ETA.srt",
        albumArt: "http://www.applesodam.kro.kr/music/NewJeans/NewJeans2ndEP'GetUp'/NewJeans2ndEP'GetUp'.jpg"
      }
      // 추가 노래들은 여기에
    ]
    // 추가 앨범들은 여기에
  };

  let currentLyrics = [];
  let currentTrackIndex = 0;

  function selectAlbum(albumName) {
    const trackListElem = document.getElementById('track-list');
    trackListElem.innerHTML = '';
    tracks[albumName].forEach((track, index) => {
      const trackElem = document.createElement('div');
      trackElem.className = 'track';
      trackElem.innerText = track.title;
      trackElem.onclick = () => playTrack(albumName, index);
      trackListElem.appendChild(trackElem);
    });
  }

  function playTrack(albumName, trackIndex) {
    const player = document.getElementById('player');
    const audio = document.getElementById('audio');
    const albumArt = document.getElementById('album-art');
    const track = tracks[albumName][trackIndex];
    currentTrackIndex = trackIndex;
    audio.src = track.src;
    albumArt.src = track.albumArt;
    player.style.display = 'flex';
    loadLyrics(track.lyrics);
    audio.play();
  }

  function loadLyrics(lyricsUrl) {
    fetch(lyricsUrl)
      .then(response => response.text())
      .then(data => {
        currentLyrics = parseSRT(data);
      });
  }

  function parseSRT(data) {
    const lines = data.split('\n');
    const lyrics = [];
    let timeRegExp = /(\d+):(\d+):(\d+),(\d+)/;
    lines.forEach(line => {
      if (timeRegExp.test(line)) {
        const times = line.match(timeRegExp);
        const timeInSeconds = parseInt(times[1]) * 3600 + parseInt(times[2]) * 60 + parseInt(times[3]) + parseInt(times[4]) / 1000;
        lyrics.push({ time: timeInSeconds, text: lines[lines.indexOf(line) + 1] });
      }
    });
    return lyrics;
  }

  function syncLyrics() {
    const audio = document.getElementById('audio');
    const lyricsElem = document.getElementById('lyrics');
    const currentTime = audio.currentTime;
    const lyric = currentLyrics.find(lyric => lyric.time <= currentTime);
    if (lyric) {
      lyricsElem.innerText = lyric.text;
    }
  }

  function togglePlayer() {
    const player = document.getElementById('player');
    player.classList.toggle('expanded');
  }

  function playArtist() {
    // 아티스트의 첫 번째 노래를 재생합니다.
    const albumNames = Object.keys(tracks);
    selectAlbum(albumNames[0]);
    playTrack(albumNames[0], 0);
  }

</script>

</body>
</html>
