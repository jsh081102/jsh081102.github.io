<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siri Music - musicOS 1.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-color: #f0f0f0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #000;
        }

        .main-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .artist-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .artist-card:hover {
            transform: scale(1.05);
        }

        .artist-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .artist-info {
            padding: 15px;
        }

        .artist-name {
            font-size: 18px;
            font-weight: 600;
        }

        .player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            width: 300px;
            transition: all 0.3s ease;
        }

        .player.expanded {
            width: 100%;
            height: 100%;
            bottom: 0;
            right: 0;
            border-radius: 0;
        }

        .player-content {
            padding: 20px;
        }

        .album-art {
            width: 260px;
            height: 260px;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .lyrics-container {
            height: 300px;
            overflow-y: auto;
            padding: 20px;
            display: none;
        }

        .lyrics-line {
            text-align: center;
            margin: 10px 0;
            opacity: 0.5;
            transition: opacity 0.3s ease;
        }

        .lyrics-line.active {
            opacity: 1;
            font-weight: bold;
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 15px;
        }

        .control-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 24px;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #ddd;
            margin: 10px 0;
            cursor: pointer;
        }

        .progress {
            height: 100%;
            background: #ff2d55;
            width: 0;
        }

        .time-info {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Siri Music</div>
        </div>
        
        <div class="main-content" id="mainContent">
            <!-- 아티스트 카드들이 동적으로 추가됨 -->
        </div>
    </div>

    <div class="player" id="player">
        <div class="player-content">
            <img src="" alt="Album Art" class="album-art" id="albumArt">
            <div class="song-info">
                <h3 id="songTitle">노래 제목</h3>
                <p id="artistName">아티스트</p>
            </div>
            <div class="progress-bar" id="progressBar">
                <div class="progress" id="progress"></div>
            </div>
            <div class="time-info">
                <span id="currentTime">0:00</span>
                <span id="duration">0:00</span>
            </div>
            <div class="controls">
                <button class="control-btn" id="prevBtn">⏮</button>
                <button class="control-btn" id="playPauseBtn">▶</button>
                <button class="control-btn" id="nextBtn">⏭</button>
            </div>
            <div class="lyrics-container" id="lyricsContainer"></div>
        </div>
    </div>

    <script>
        const audioPlayer = new Audio();
        let currentLyrics = [];
        let isPlaying = false;

        // 샘플 데이터
        const musicData = {
            artists: [
                {
                    name: 'NewJeans',
                    image: 'http://www.applesodam.kro.kr/music/NewJeans/NewJeans.jpg',
                    albums: [
                        {
                            name: "NewJeans2ndEP'GetUp'",
                            image: "http://www.applesodam.kro.kr/music/NewJeans/NewJeans2ndEP'GetUp'/NewJeans2ndEP'GetUp'.jpg",
                            songs: [
                                {
                                    title: 'ETA',
                                    path: "http://www.applesodam.kro.kr/music/NewJeans/NewJeans2ndEP'GetUp'/ETA.mp3",
                                    lyrics: "http://www.applesodam.kro.kr/music/NewJeans/NewJeans2ndEP'GetUp'/ETA.srt"
                                }
                            ]
                        }
                    ]
                }
            ]
        };

        // 아티스트 카드 생성
        function createArtistCards() {
            const mainContent = document.getElementById('mainContent');
            musicData.artists.forEach(artist => {
                const card = document.createElement('div');
                card.className = 'artist-card';
                card.innerHTML = `
                    <img src="${artist.image}" alt="${artist.name}" class="artist-image">
                    <div class="artist-info">
                        <div class="artist-name">${artist.name}</div>
                    </div>
                `;
                card.onclick = () => showArtistDetails(artist);
                mainContent.appendChild(card);
            });
        }

        // 노래 재생 함수
        function playSong(song) {
            audioPlayer.src = song.path;
            audioPlayer.play();
            isPlaying = true;
            document.getElementById('playPauseBtn').textContent = '⏸';
            document.getElementById('songTitle').textContent = song.title;
            
            // 가사 로드
            fetch(song.lyrics)
                .then(response => response.text())
                .then(text => parseLyrics(text));
        }

        // SRT 형식 가사 파싱
        function parseLyrics(srtText) {
            const lyrics = [];
            const lines = srtText.split('\n\n');
            
            lines.forEach(line => {
                const parts = line.split('\n');
                if (parts.length >= 3) {
                    const timeStr = parts[1].split(' --> ')[0];
                    const text = parts[2];
                    const time = parseTimeStr(timeStr);
                    lyrics.push({ time, text });
                }
            });

            currentLyrics = lyrics;
            updateLyricsDisplay();
        }

        // 시간 문자열 파싱 (00:00:00,000 형식)
        function parseTimeStr(timeStr) {
            const [h, m, s] = timeStr.split(':');
            const [seconds, ms] = s.split(',');
            return (parseInt(h) * 3600 + parseInt(m) * 60 + parseInt(seconds)) + parseInt(ms) / 1000;
        }

        // 가사 업데이트
        function updateLyricsDisplay() {
            const container = document.getElementById('lyricsContainer');
            container.innerHTML = '';
            
            currentLyrics.forEach(lyric => {
                const div = document.createElement('div');
                div.className = 'lyrics-line';
                div.textContent = lyric.text;
                container.appendChild(div);
            });
        }

        // 이벤트 리스너 설정
        document.getElementById('playPauseBtn').onclick = () => {
            if (isPlaying) {
                audioPlayer.pause();
                isPlaying = false;
                document.getElementById('playPauseBtn').textContent = '▶';
            } else {
                audioPlayer.play();
                isPlaying = true;
                document.getElementById('playPauseBtn').textContent = '⏸';
            }
        };

        audioPlayer.ontimeupdate = () => {
            const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            document.getElementById('progress').style.width = `${progress}%`;
            
            // 현재 시간에 맞는 가사 하이라이트
            const currentTime = audioPlayer.currentTime;
            const lyricsLines = document.querySelectorAll('.lyrics-line');
            
            currentLyrics.forEach((lyric, index) => {
                if (currentTime >= lyric.time && 
                    (index === currentLyrics.length - 1 || currentTime < currentLyrics[index + 1].time)) {
                    lyricsLines.forEach(line => line.classList.remove('active'));
                    lyricsLines[index].classList.add('active');
                }
            });
        };

        // 초기화
        createArtistCards();
    </script>
</body>
</html>
